function Scene(a){jsonConcat(this,a),this.ratio=a.ratio||90,this.heightRatio=void 0==a.height?a.heightRatio||75:a.height/a.width,this.perspective=a.perspective||800,this.height=a.height,this.width=a.width,this.unit=a.unit||"m",this.id=a.id||"scene"+Math.ceil(100*Math.random()),this.containerId=a.containerId||"sceneContainer"+Math.ceil(100*Math.random()),this.sizeType=a.sizeType||"window",this.type=a.type||"3d",this.pxr=a.pxr,this.objects=a.objects||[],this.render=a.render||!0,this.renderCss=function(){$("#"+this.id).css(this.css)},this.addRootObject=function(b){b.id&&(this.objects[b.id]=b),"window"==this.sizeType&&this.objects[b.id]!==void 0&&(this.pxr=window.innerWidth*(this.objects[b.id].ratio/100)/this.objects[b.id].width,this.objects[b.id].object=new Cube({height:this.objects[b.id].height,width:this.objects[b.id].width,depth:this.objects[b.id].depth,unit:this.objects[b.id].unit,ratio:this.objects[b.id].ratio,id:this.objects[b.id].id,render:!0,pxr:this.pxr,unit:b.unit|this.unit,scene:{type:"window",id:"scene"}})),!0==this.objects[b.id].render&&this.objects[b.id].sceneObjectId==void 0&&this.objects[b.id].object.render({pxr:this.pxr})},this.clear=function(b){if(!b)var b={};!1!==b.pxr&&(this.pxr=void 0),$("#"+this.id).html("")},"window"==this.sizeType?"3d"==this.type?this.css={perspective:this.perspective+"px"}:"2d"==this.type&&(this.css={}):this.sizeType=="object"&&("3d"==this.type?this.css={perspective:this.perspective+"px"}:"2d"==this.type&&(this.css={})),this.render&&this.renderCss()}function Element(){}Element.prototype={initialize:function(a){if(!a)var a={};this.id=a.id,this.class=a.class,this.height=a.height,this.width=a.width,this.css=a.css,this.position=a.position,this.render=a.render,this.renderState=a.renderState},draw:function(){}};function Cube(a){jsonConcat(this,a),this.id=a.id||uuidv4(),this.class=a.class||"l3Object",this.height=a.height||5,this.width=a.width||5,this.depth=a.depth||5,this.unit=a.unit||"cm",this.scene=a.scene||a.parent.scene,this.ratio=a.ratio||this.scene.ratio||90,this.sides=a.sides||["front","back","left","right","bottom","top"],this.faces={},this.position={x:0,y:0,z:0,rx:0,ry:0,rz:0,unit:"m"},jsonConcat(this.position,a.position),this.sizeSelf="group"!==a.type&&(a.sizeSelf||!0),this.render=a.render,void 0==this.render&&(this.render=!0),this.data=a.data,this.zIndex=a.zIndex,this.labels=a.labels||[],this.minPxWidth=a.minPxWidth,this.datas=a.datas,void 0==this.scene.objects[this.id]&&(this.scene.objects[this.id]=this),void 0==this.position.rx&&(this.position.rx=0),void 0==this.position.ry&&(this.position.ry=0),void 0==this.position.rz&&(this.position.rz=0),a.position||(a.position={}),this.position.unit=a.position.unit||this.unit||"cm",this.parent=a.parent,this.group=a.group,this.children=[],this.type=a.type||"3d",this.svg=a.svg,this.functions=[],this.tmps=a.tmps||{},this.addChild=function(k){this.children.push(k)},this.Face=function(k){this.side=k.side,this.id=k.id||uuidv4(),this.uuid=k.uuid||uuidv4(),this.class=k.side,this.parent=k.parent,this.features=k.features,this.type=k.type||"3d",this.unit=k.unit,this.unitScale=k.unitScale,this.pxr=k.pxr,"front"==this.side?(this.height=k.height,this.width=k.width,this.heightPx=Math.ceil(k.height/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.width/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px"}):"back"==this.side?(this.height=k.height,this.width=k.width,this.heightPx=Math.ceil(k.height/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.width/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px",transform:"translate3d(0px, 0px, -"+k.depth/this.unitScale*this.pxr+"px)"}):"right"==this.side?(this.height=k.height,this.width=k.depth,this.heightPx=Math.ceil(k.height/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.depth/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px",transform:"rotateY(90deg)  translate3d("+this.widthPx/2+"px, 0px, "+k.width/this.unitScale*this.pxr/2+"px)"}):"left"==this.side?(this.height=k.height,this.width=k.depth,this.heightPx=Math.ceil(k.height/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.depth/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px",transform:"rotateY(-90deg)  translate3d(-"+this.widthPx/2+"px, 0px, "+k.width/this.unitScale*this.pxr/2+"px)"}):"bottom"==this.side?(this.height=k.depth,this.width=k.width,this.heightPx=Math.ceil(k.depth/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.width/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px",transform:"rotateX(-90deg) translate3d(0px, "+0.5*this.heightPx+"px, "+-1*((k.depth/this.unitScale/2-k.height/this.unitScale)*this.pxr)+"px)"}):"top"==this.side&&(this.height=k.depth,this.width=k.width,this.heightPx=Math.ceil(k.depth/this.unitScale*this.pxr),this.widthPx=Math.ceil(k.width/this.unitScale*this.pxr),this.css={width:this.widthPx+"px",height:this.heightPx+"px",transform:"rotateX(-90deg) translate3d(0px, "+0.5*this.heightPx+"px, "+-1*Math.ceil(k.depth/this.unitScale/2*this.pxr)+"px)"}),this.addFeature=function(){this.features.push(feature)}},this.createFaces=function(){if("2d"==this.type){if(0<this.sides.length){var k=new this.Face({side:this.sides[0],height:this.height,width:this.width,depth:this.depth,unit:this.unit,unitScale:this.unitScale,pxr:this.scene.pxr,type:"2d"});this.faces[this.sides[0]]=k}}else if("3d"==this.type)for(var k,m=0;m<this.sides.length;m++)k=new this.Face({side:this.sides[m],height:this.height,width:this.width,depth:this.depth,unit:this.unit,unitScale:this.unitScale,pxr:this.scene.pxr,parent:this}),this.faces[this.sides[m]]=k;else if("custom"==this.type)for(i=0;i<this.sides.length;i++){var k=new this.Face({side:this.sides[i],height:this.height,width:this.width,depth:this.depth,unit:this.unit,unitScale:this.unitScale,pxr:this.scene.pxr,parent:this});this.faces[this.sides[i]]=k}else if("svg"==this.type);},this.draw=function(){if(void 0!==this.parent)var m=" #"+this.parent.id;else var m="";if(this.tmps.parentId=m,this.group){this.group.positioner?1>$("#"+this.scene.id+m+" #"+this.group.id+"-positioner").length&&(this.group.positioner={},this.group.positioner.object=new Cube({sides:[],id:this.group.id+"-positioner",class:this.group.class+"-group-positioner group-positioner",parent:this.parent,scene:this.scene,type:"group"}),this.group.object=new Cube({sides:[],id:this.group.id,class:this.group.class+" group",parent:this.group.positioner.object,scene:this.group.positioner.object.scene,type:"group"})):1>$("#"+this.scene.id+m+" #"+this.group.id).length&&(this.group.object=new Cube({sides:[],id:this.group.id,class:this.group.class+" group",parent:this.parent,scene:this.scene,type:"group"}));var n=$("<div>",{id:this.id,class:this.class+" dObject"});$("#"+this.scene.id+m+" #"+this.group.id).append(n)}else{var n=$("<div>",{id:this.id,class:this.class+" dObject"});$("#"+this.scene.id+m).append(n)}if(this.datas&&this.datas.forEach((B,C)=>{$("#"+this.scene.id+m+" #"+this.id).attr("data-"+this.datas[C].property,this.datas[C].value)}),"2d"==this.type){if(0<this.sides.length){var o=$("<div>",{id:this.faces[this.sides[0]].id+"Parent",class:"faceParent "+this.sides[0]+"Parent"});$("#"+this.scene.id+m+" #"+this.id).append(o);var p=$("<div>",{id:this.faces[this.sides[0]].id,class:"face "+this.sides[0]});$("#"+this.scene.id+m+" #"+this.id+" > #"+this.faces[this.sides[0]].id+"Parent").append(p),$("#"+this.scene.id+m+" #"+this.id+" > #"+this.faces[this.sides[0]].id+"Parent #"+this.faces[this.sides[0]].id).css(this.faces[this.sides[0]].css)}}else if("3d"==this.type)for(var o,q=0;q<this.sides.length;q++){o=$("<div>",{id:this.faces[this.sides[q]].id+"Parent",class:"faceParent "+this.sides[q]+"Parent"}),$("#"+this.scene.id+m+" #"+this.id).append(o);var p=$("<div>",{id:this.faces[this.sides[q]].id,class:"face "+this.sides[q]});$("#"+this.scene.id+m+" #"+this.id+" > #"+this.faces[this.sides[q]].id+"Parent").append(p),$("#"+this.scene.id+m+" #"+this.id+" > #"+this.faces[this.sides[q]].id+"Parent #"+this.faces[this.sides[q]].id).css(this.faces[this.sides[q]].css)}else if("svg"==this.type){var r=$(SVG("svg")).attr("class","wavelengthSvg").attr("id",uuidv4());svgCss={height:this.height/this.unitScale*this.scene.pxr},$("#"+this.scene.id+m+" #"+this.id).append(r),$("#"+this.scene.id+m+" #"+this.id+" #"+r[0].id).css(svgCss);var s="";this.svg.points.forEach((B,C)=>{s+=Math.floor(this.svg.points[C].x/this.unitScale*this.scene.pxr)+","+Math.floor(this.svg.points[C].y/this.unitScale*this.scene.pxr)+" "});var u=$(SVG("polygon"));u.attr("class","wavelengthPolygon "+this.svg.class).attr("id",uuidv4()).attr("points",s),this.svg.elem={element:r,polygon:u},$("#"+this.scene.id+m+" #"+this.id+" #"+r[0].id).append(u)}else if("canvas"==this.type){var v="";this.tmps.canvasParentId=v;var w=this.canvas.class||"";if(this.canvas&&this.canvas.positioner){canvasParentCss={},this.canvas&&this.canvas.size&&this.canvas.size.parent&&(this.canvas.size.parent.height&&(canvasParentCss.height=this.height/this.unitScale*this.scene.pxr),this.canvas.size.parent.width&&(canvasParentCss.width=this.width/this.unitScale*this.scene.pxr),!this.canvas.size.parent.height&&!this.canvas.size.parent.height&&(canvasParentCss.height=this.height/this.unitScale*this.scene.pxr));var z=$("<div>",{class:w+"l3CanvasParent"||"l3CanvasParent",id:this.canvas.parentId||uuidv4()});$("#"+this.scene.id+v+" #"+this.id).append(z),$("#"+this.scene.id+v+" #"+this.id+" #"+z[0].id).css(canvasParentCss),v=" #"+z[0].id,this.tmps.canvasParentId=v,this.tmps.$canvasParent=z}!1!==this.canvas.render&&this.renderCanvas()}if("function"==typeof this.hoverListener&&this.functions.push(this.hoverListener(this.canvas)),this.sizeSelf&&$("#"+this.scene.id+m+" #"+this.id).css({width:this.widthPx,height:this.heightPx}),this.position)if(this.updateUnitScale(),this.parent){if("center"==this.position.type){var A=Math.ceil(this.widthPx/2);adjustY=Math.ceil(this.heightPx/-2),adjustZ=Math.ceil(this.depthPx/2),this.position.ox=(this.parent.position.ox/this.parent.position.unitScale+(this.position.x/this.position.unitScale-this.width/this.unitScale/2))*this.position.unitScale,this.position.oy=(this.parent.position.oy/this.parent.position.unitScale+(this.position.y/this.position.unitScale-this.height/this.unitScale/2))*this.position.unitScale,this.position.oz=(this.parent.position.oz/this.parent.position.unitScale+(this.position.z/this.position.unitScale-this.depth/this.unitScale/2))*this.position.unitScale}else{var A=0;adjustY=0,adjustZ=0,this.position.ox=(this.parent.position.ox/this.parent.position.unitScale+this.position.x/this.position.unitScale)*this.position.unitScale,this.position.oy=(this.parent.position.oy/this.parent.position.unitScale+this.position.y/this.position.unitScale)*this.position.unitScale,this.position.oz=(this.parent.position.oz/this.parent.position.unitScale+this.position.z/this.position.unitScale)*this.position.unitScale}if(0>this.position.z)this.transformString="translate3d("+Math.ceil(this.position.x/this.position.unitScale*this.scene.pxr-A)+"px,"+-1*Math.ceil(this.position.y/this.position.unitScale*this.scene.pxr+adjustY)+"px,"+Math.ceil(-1*(this.position.z/this.position.unitScale*this.scene.pxr-adjustZ))+"px) rotateX("+this.position.rx+"deg) rotateY("+this.position.ry+"deg) rotateZ("+this.position.rz+"deg)",$("#"+this.scene.id+" #"+this.id).css({transform:this.transformString});else{if(this.parent.id)var m=" #"+this.parent.id;else var m="";this.transformString="translate3d("+Math.ceil(this.position.x/this.position.unitScale*this.scene.pxr-A)+"px,"+-1*Math.ceil(this.position.y/this.position.unitScale*this.scene.pxr+adjustY)+"px,"+Math.ceil(-1*(this.position.z/this.position.unitScale*this.scene.pxr-adjustZ))+"px) rotateX("+this.position.rx+"deg) rotateY("+this.position.ry+"deg) rotateZ("+this.position.rz+"deg)",$("#"+this.scene.id+m+" #"+this.id).css({transform:this.transformString})}}else this.position.ox=this.position.x,this.position.oy=this.position.y,this.position.oz=this.position.z,this.transformString="translate3d("+Math.ceil(this.position.x/this.position.unitScale*this.scene.pxr)+"px,"+Math.ceil(this.position.y/this.position.unitScale*this.scene.pxr)+"px,"+Math.ceil(this.position.z/this.position.unitScale*this.scene.pxr)+"px) rotateX("+this.position.rx+"deg) rotateY("+this.position.ry+"deg) rotateZ("+this.position.rz+"deg)",$("#"+this.scene.id+" #"+this.id).css({transform:this.transformString});this.zIndex&&$("#"+this.id).css({"z-index":this.zIndex}),this.style&&this.faces},this.moveTo=function(k){var m=k.x||this.position.x;if(newY=k.y||this.position.y,newZ=k.z||this.position.z,this.position.unit=k.unit||this.position.unit,this.updateUnitScale(),this.position.x=m,this.position.y=newY,this.position.z=newZ,"center"==this.position.type){var n=Math.ceil(this.width/this.unitScale/2);adjustY=Math.ceil(this.height/this.unitScale/-2),adjustZ=Math.ceil(this.depth/this.unitScale/2)}else{var n=0;adjustY=0,adjustZ=0}this.parent?(this.position.ox=(this.parent.position.ox/this.parent.position.unitScale+(this.position.x/this.position.unitScale-n))*this.position.unitScale,this.position.oy=(this.parent.position.oy/this.parent.position.unitScale+(this.position.y/this.position.unitScale-adjustY))*this.position.unitScale,this.position.oz=(this.parent.position.oz/this.parent.position.unitScale+(this.position.z/this.position.unitScale-adjustZ))*this.position.unitScale):(this.position.ox=this.position.x,this.position.oy=this.position.y,this.position.oz=this.position.z);var o="translate3d("+Math.ceil(this.position.x/this.position.unitScale*this.scene.pxr-n*this.scene.pxr)+"px,"+-1*Math.ceil(this.position.y/this.position.unitScale*this.scene.pxr+adjustY*this.scene.pxr)+"px,"+Math.ceil(-1*(this.position.z/this.position.unitScale*this.scene.pxr-adjustZ*this.scene.pxr))+"px) rotateX("+this.position.rx+"deg) rotateY("+this.position.ry+"deg) rotateZ("+this.position.rz+"deg)",p=d3.select($("#"+this.id).get(0)),q=d3.interpolateString(this.transformString,o);this.transformString=o,p.transition().duration(800).styleTween("transform",function(){return q})},this.updateUnitScale=function(){this.position.unitScale="m"==this.position.unit?1:"cm"==this.position.unit?100:"mm"==this.position.unit?1e3:"um"==this.position.unit?1e4:1},this.setUnitScale=function(){this.unitScale="m"==this.unit?1:"cm"==this.unit?100:"mm"==this.unit?1e3:"um"==this.unit?1e4:1},this.setPxs=function(k){this.widthPx=0==this.width?1:Math.ceil(this.scene.pxr*(this.width/this.unitScale)),this.depthPx=0==this.depth?0:Math.ceil(this.scene.pxr*(this.depth/this.unitScale)),this.heightPx=0==this.height?0:Math.ceil(this.scene.pxr*(this.height/this.unitScale))},this.renderCanvas=function(){var n=this.canvas.class||"",o=this.tmps.parentId,p=this.tmps.canvasParentId,q=this.tmps.$canvasParent,r=$("<canvas/>",{class:n+" l3canvas",id:this.canvas.id||uuidv4()});this.canvas.elem={parentElement:q,canvas:r},$("#"+this.scene.id+o+" #"+this.id+p).append(r);var s={};for(key in this.canvas&&this.canvas.size&&(this.canvas.size.inherit?(this.canvas.size.height&&(s.height=this.height/this.unitScale*this.scene.pxr),this.canvas.size.width&&(s.width=this.width/this.unitScale*this.scene.pxr)):(this.canvas.size.height&&(s.height=this.height/this.unitScale*this.scene.pxr),this.canvas.size.width&&(s.width=this.canvas.width/this.unitScale*this.scene.pxr))),s)s.hasOwnProperty(key)&&$("#"+this.scene.id+o+" #"+this.id+p+" #"+r[0].id).attr(key,s[key]);var u=$("#"+r[0].id)[0],v=u.getContext("2d");this.canvas.canvas=u,this.canvas.context=v,this.canvas.context.translate(0.5,0),this.canvas.context.lineCap="round",this.canvas.context.imageSmoothingQuality="high",this.canvas.context.imageSmoothingEnabled=!0,"polygon"==this.canvas.type?this.drawPath(this.canvas.points):"polygons"==this.canvas.type?this.canvas.paths&&this.canvas.paths.forEach(w=>{this.drawPath(w)}):"rect"==this.canvas.type?this.canvas.pxRect=this.canvas.pxRect||{}:"rects"==this.canvas.type&&(this.canvas.pxRects=this.canvas.pxRects||[],this.canvas.rects[0].hasOwnProperty("rect")?this.canvas.rects.forEach(w=>{this.drawPath(w.rect)}):this.canvas.rects[0].hasOwnProperty("fillStyle"))},this.drawPath=function(k,m){if(!k)var k={};if(!k.fillStyle)var n=this.canvas.fillStyle||"rgb(100,100,100)";else if(k.fillStyle)var n=k.fillStyle;else var n="rgb(200,200,200)";var o="source-over";if(this.canvas&&this.canvas.canvas&&this.canvas.context){if(k.composite)var o=k.composite;this.canvas.context.globalCompositeOperation=o,"polygon"==this.canvas.type||"polygons"==this.canvas.type?(this.canvas.context.beginPath(),k.pointsPx=[],k.points.forEach((p,q)=>{"px"===this.canvas.unit?"px"==this.canvas.unit&&(0==q?(this.canvas.context.moveTo(Math.round(k.points[q].x),Math.round(k.points[q].y)),k.pointsPx.push({x:Math.round(k.points[q].x),y:Math.round(k.points[q].y)})):(this.canvas.context.lineTo(Math.round(k.points[q].x),Math.round(k.points[q].y)),k.pointsPx.push({x:Math.round(k.points[q].x),y:Math.round(k.points[q].y)}))):0==q?(this.canvas.context.moveTo(Math.round(k.points[q].x/this.unitScale*this.scene.pxr),Math.round(k.points[q].y/this.unitScale*this.scene.pxr)),k.pointsPx.push({x:Math.round(k.points[q].x/this.unitScale*this.scene.pxr),y:Math.round(k.points[q].y/this.unitScale*this.scene.pxr)})):(this.canvas.context.lineTo(Math.round(k.points[q].x/this.unitScale*this.scene.pxr),Math.round(k.points[q].y/this.unitScale*this.scene.pxr)),k.pointsPx.push({x:Math.round(k.points[q].x/this.unitScale*this.scene.pxr),y:Math.round(k.points[q].y/this.unitScale*this.scene.pxr)}))}),n&&(this.canvas.context.fillStyle=n),this.canvas.context.fill(),this.canvas.context.closePath()):("rect"==this.canvas.type||"rects"==this.canvas.type)&&(this.canvas.context.beginPath(),"px"===this.canvas.unit?"px"==this.canvas.unit&&this.canvas.context.rect(k.position.x,k.position.y,k.width,k.height):this.canvas.context.rect(k.position.x/this.unitScale*this.scene.pxr,k.position.y/this.unitScale*this.scene.pxr,k.width/this.unitScale*this.scene.pxr,k.height/this.unitScale*this.scene.pxr),this.canvas.context.fillStyle=n,this.canvas.context.fill())}},this.redraw=function(k,m){if(!k)var k={};if("canvas"==this.type)if("polygon"==this.canvas.type)k.transition||(this.canvas.context=this.canvas.canvas.getContext("2d"),k.canvas&&k.canvas.points&&(this.canvas.context.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.context.translate(0.5,0),this.canvas.points=k.canvas.points,this.drawPath(this.canvas)));else if("polygons"==this.canvas.type){if(k.canvas&&(this.canvas.canvas.width=k.canvas.width/this.unitScale*this.scene.pxr||this.canvas.canvas.width),k.canvas&&(this.canvas.canvas.height=k.canvas.height/this.unitScale*this.scene.pxr||this.canvas.canvas.height),k.transition){for(path in this.canvas.paths)if(this.canvas.paths.hasOwnProperty(path))for(point in this.canvas.paths[path].points)this.canvas.paths[path].points.hasOwnProperty(point)&&(this.canvas.paths[path].points[point].sx=Math.round(this.canvas.paths[path].points[point].x),this.canvas.paths[path].points[point].sy=Math.round(this.canvas.paths[path].points[point].y),k.canvas.paths&&(this.canvas.paths[path].points[point].tx=Math.round(k.canvas.paths[path].points[point].x),this.canvas.paths[path].points[point].ty=Math.round(k.canvas.paths[path].points[point].y)));var n=k.transition.duration||300,o=k.transition.ease||d3.easeCubic,p=d3.timer(q=>{const r=Math.min(1,o(q/n));for(path in this.canvas.paths)if(this.canvas.paths.hasOwnProperty(path))for(point in this.canvas.paths[path].points)this.canvas.paths[path].points.hasOwnProperty(point)&&(this.canvas.paths[path].points[point].x=Math.round(this.canvas.paths[path].points[point].sx*(1-r)+k.canvas.paths[path].points[point].x*r),this.canvas.paths[path].points[point].y=Math.round(this.canvas.paths[path].points[point].sy*(1-r)+k.canvas.paths[path].points[point].y*r));this.redrawAuxPaths(),1===r&&p.stop()})}}else if("rect"==this.canvas.type);},this.redrawAuxPaths=function(){var k=this.canvas.context;if(this.canvas.paths)for(path in k.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.canvas.paths)this.canvas.paths.hasOwnProperty(path)&&this.drawPath(this.canvas.paths[path])},this.setUnitScale();var b=window.innerWidth*(this.ratio/100),c=.8*window.innerWidth,e=this.width/this.unitScale,g=$("#"+this.scene.id).width()*(this.ratio/100);if(void 0==this.scene||("window"==this.scene.sizeType?(void 0==this.scene.pxr&&(this.scene.pxr=b/e,this.minPxWidth&&this.scene.pxr*e<this.minPxWidth&&(this.scene.pxr=this.minPxWidth/e),this.scene.pxr*e>c&&(this.scene.pxr=c/e)),this.setPxs(),this.createFaces()):"object"==this.scene.sizeType&&(void 0==this.scene.pxr?(this.scene.pxr=g/e,this.minPxWidth&&this.scene.pxr*e<this.minPxWidth&&(this.scene.pxr=this.minPxWidth/e),this.scene.pxr*e>=c&&(this.scene.pxr=c/e)):this.scene.pxr*e>=this.minPxWidth&&(this.minPxWidth&&this.scene.pxr*e<this.minPxWidth&&(this.scene.pxr=this.minPxWidth/e),this.scene.pxr*e>=c&&(this.scene.pxr=c/e)),this.setPxs(),this.createFaces())),this.parent&&"group"!==this.type&&this.parent.children.push(this),this.render&&this.draw(),this.data)if(this.data.link)"<a href="+this.data.link+">"+this.data.text+"</a>";else this.data.do?$("#"+this.id).attr("onclick",this.data.do).append(this.data.text):this.data&&$("#"+this.id).append(this.data.text)}function L3(){this.units=["km","m","cm","mm","um","miles","ft","inches"],this.unitScale=function(b){return"m"==b?1:"cm"==b?100:"cm"==b?100:"mm"==b?1e3:"um"==b?1e4:"ft"==b?3.28084:"inches"==b?39.3701:1},this.unitScaleR=function(){},this.convertAreaScale=function(b,c){var e=0;return!("m"!=c)&&(this.units.forEach(g=>{g==c&&(e=this.unitScale(b)*this.unitScale(b))}),e)},this.pointInPolygon=function(b,c,e){if(!e)var e={};if(!e.type)var g="x",h="y",k="z";else if("useStrings"==e.type)var g="x",h="y",k="z";else if("normal"==e.type)var g=0,h=1,k=2;for(var m=b[g],n=b[h],o=!1,p=0,q=c.length-1;p<c.length;q=p++){var r=c[p][g],s=c[p][h],u=c[q][g],v=c[q][h];s>n!=v>n&&m<(u-r)*(n-s)/(v-s)+r&&(o=!o)}return o},this.pointInRect=function(b,c,e){if("px"!==c.unit)var g=[{x:c.position.x,y:c.position.y},{x:c.position.x,y:c.position.y+c.height},{x:c.position.x+c.width,y:c.position.y+c.height},{x:c.position.x+c.width,y:c.position.y}];else if("px"==c.unit)var g=[{x:c.position.x,y:c.position.y},{x:c.position.x,y:c.position.y+c.height},{x:c.position.x+c.width,y:c.position.y+c.height},{x:c.position.x+c.width,y:c.position.y}];if(!e)var e={};if(!e.type)var h="x",k="y",m="z";else if("useStrings"==e.type)var h="x",k="y",m="z";else if("normal"==e.type)var h=0,k=1,m=2;for(var n=b[h],o=b[k],p=!1,q=0,r=g.length-1;q<g.length;r=q++){var s=g[q][h],u=g[q][k],v=g[r][h],w=g[r][k];u>o!=w>o&&n<(v-s)*(o-u)/(w-u)+s&&(p=!p)}return p},this.finit=function(b,c){},this.findCurrentPath=function(b,c){this.finit(b,c);var e,g=-Infinity;for(path in b.paths)if(b.paths.hasOwnProperty(path)){var h=b.paths[path];h.zIndex>g&&this.pointInPolygon(b.mouse,h.pointsPx)&&(e=h,g=h.zIndex)}return e},this.findCurrentRect=function(b,c){this.finit(b,c);var e,g=-Infinity;for(rect in b.rects)if(b.rects.hasOwnProperty(rect)){var h=b.rects[rect];this.pointInRect(b.mouse,h)&&h.zIndex>g&&(e=h,g=h.zIndex)}return e},this.propToString=function(b,c){for(var e in b)if(b[e]==c)return e;return!1},this.scenePxrs=[],this.scene=Scene,this.cube=Cube,this.ai=this}function Polygon(){}function Group(){}var l3=new L3;